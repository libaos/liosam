<?xml version="1.0"?>
<launch>
  <!-- Arguments for vision detection -->
  <arg name="model_path" default="$(find lidar_vision_detection)/models/yolov3.weights" />
  <arg name="config_path" default="$(find lidar_vision_detection)/models/yolov3.cfg" />
  <arg name="class_names_file" default="$(find lidar_vision_detection)/models/coco.names" />
  <arg name="confidence_threshold" default="0.5" />

  <!-- Include LIO-SAM-based navigation from the original project (unchanged) -->
  <include file="$(find lio_sam_move_base_tutorial)/robot_gazebo/scout_gazebo/launch/scout_gazebo.launch">
    <!-- Keep all default parameters -->
  </include>
  
  <!-- Launch the vision detection node -->
  <node pkg="lidar_vision_detection" type="vision_detection_node" name="vision_detection_node" output="screen">
    <!-- Set up topic remapping for integration -->
    <remap from="image" to="/camera/image_raw" />
    <remap from="points" to="/velodyne_points" />
    
    <!-- Parameters -->
    <param name="model_path" value="$(arg model_path)" />
    <param name="config_path" value="$(arg config_path)" />
    <param name="class_names_file" value="$(arg class_names_file)" />
    <param name="confidence_threshold" value="$(arg confidence_threshold)" />
  </node>

  <!-- Launch RViz for visualization -->
  <node pkg="rviz" type="rviz" name="rviz" 
        args="-d $(find lidar_vision_detection)/rviz/detection_visualization.rviz" />
</launch> 